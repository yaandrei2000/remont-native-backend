enum BugReportCategory {
  UI
  PERFORMANCE
  FUNCTIONALITY
  DATA
  OTHER
}

enum BugReportPriority {
  LOW
  MEDIUM
  HIGH
}

enum BugReportStatus {
  NEW
  IN_PROGRESS
  RESOLVED
  CLOSED
}

model BugReport {
  id          String            @id @default(cuid())
  userId      String?
  user        User?             @relation("UserBugReports", fields: [userId], references: [id], onDelete: SetNull)
  category    BugReportCategory
  priority    BugReportPriority @default(MEDIUM)
  status      BugReportStatus   @default(NEW)
  description String
  steps       String?
  email       String
  logFileUrl  String? // URL лог-файла в S3
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  resolvedAt  DateTime?

  images BugReportImage[]

  @@index([userId])
  @@index([status])
  @@index([category])
  @@index([createdAt])
  @@map("bug_reports")
}

model BugReportImage {
  id          String    @id @default(cuid())
  bugReportId String
  bugReport   BugReport @relation(fields: [bugReportId], references: [id], onDelete: Cascade)
  imageUrl    String // URL изображения в S3
  order       Int       @default(0) // Порядок отображения
  createdAt   DateTime  @default(now())

  @@index([bugReportId])
  @@index([order])
  @@map("bug_report_images")
}

